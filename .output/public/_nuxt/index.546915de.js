import{u as te}from"./vue.f36acd1f.edfe3d00.js";import{E as le,r as k,F as ne,G as oe,H as se,I as R,J as ie,q as re,K as ue,L as r,M as de,d as ce,N as q,O as V,c as me,i as m,t as fe,v as _e,z as e,A as l,B as y,P as S,Q as ve,x as T,y as N,R as F}from"./entry.4aa671c5.js";function L(...g){var O;const f=typeof g[g.length-1]=="string"?g.pop():void 0;typeof g[0]!="string"&&g.unshift(f);let[t,p,a={}]=g;if(typeof t!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof p!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const n=re(),C=()=>null,D=()=>n.isHydrating?n.payload.data[t]:n.static.data[t];a.server=a.server??!0,a.default=a.default??C,a.getCachedData=a.getCachedData??D,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0,a.deep=a.deep??le.deep;const h=()=>![null,void 0].includes(a.getCachedData(t));if(!n._asyncData[t]||!a.immediate){(O=n.payload._errors)[t]??(O[t]=null);const u=a.deep?k:ne;n._asyncData[t]={data:u(a.getCachedData(t)??a.default()),pending:k(!h()),error:oe(n.payload._errors,t),status:k("idle")}}const i={...n._asyncData[t]};i.refresh=i.execute=(u={})=>{if(n._asyncDataPromises[t]){if(u.dedupe===!1)return n._asyncDataPromises[t];n._asyncDataPromises[t].cancelled=!0}if((u._initial||n.isHydrating&&u._initial!==!1)&&h())return Promise.resolve(a.getCachedData(t));i.pending.value=!0,i.status.value="pending";const x=new Promise((c,v)=>{try{c(p(n))}catch($){v($)}}).then(c=>{if(x.cancelled)return n._asyncDataPromises[t];let v=c;a.transform&&(v=a.transform(c)),a.pick&&(v=pe(v,a.pick)),n.payload.data[t]=v,i.data.value=v,i.error.value=null,i.status.value="success"}).catch(c=>{if(x.cancelled)return n._asyncDataPromises[t];i.error.value=ue(c),i.data.value=r(a.default()),i.status.value="error"}).finally(()=>{x.cancelled||(i.pending.value=!1,delete n._asyncDataPromises[t])});return n._asyncDataPromises[t]=x,n._asyncDataPromises[t]};const _=()=>i.refresh({_initial:!0}),d=a.server!==!1&&n.payload.serverRendered;{const u=de();if(u&&!u._nuxtOnBeforeMountCbs){u._nuxtOnBeforeMountCbs=[];const c=u._nuxtOnBeforeMountCbs;u&&(se(()=>{c.forEach(v=>{v()}),c.splice(0,c.length)}),R(()=>c.splice(0,c.length)))}d&&n.isHydrating&&(i.error.value||h())?(i.pending.value=!1,i.status.value=i.error.value?"error":"success"):u&&(n.payload.serverRendered&&n.isHydrating||a.lazy)&&a.immediate?u._nuxtOnBeforeMountCbs.push(_):a.immediate&&_(),a.watch&&ie(a.watch,()=>i.refresh());const x=n.hook("app:data:refresh",async c=>{(!c||c.includes(t))&&await i.refresh()});u&&R(x)}const P=Promise.resolve(n._asyncDataPromises[t]).then(()=>i);return Object.assign(P,i),P}function pe(g,f){const t={};for(const p of f)t[p]=g[p];return t}const ye={style:{padding:"1rem"}},ke={class:"text-h5"},ge=T("h3",null,"No Data Found",-1),xe=ce({__name:"index",async setup(g){let f,t;te({title:"Dashboard - FastPrint"});const p=k("false"),{data:a,refresh:n}=([f,t]=q(()=>L("item",()=>$fetch(`/api/produk?all=${p.value}`))),f=await f,t(),f),{data:C}=([f,t]=q(()=>L("selects",()=>$fetch("/api/select"))),f=await f,t(),f),D=k(!1),h=k(!1),i=[V({title:"ID Produk",align:"start",sortable:!1,key:"id_produk"}),V({title:"Nama",key:"nama_produk",width:"35%"}),V({title:"Harga",key:"harga"}),V({title:"Kategori",key:"kategori.nama_kategori"}),V({title:"Status",key:"status_label"}),V({title:"Actions",key:"actions",sortable:!1})],_=k(-1),d=k({id_produk:"",nama_produk:"",harga:0,kategori_id:"",status_id:""}),P=k({id_produk:"",nama_produk:"",harga:0,kategori_id:"",status_id:""}),O=me(()=>_.value===-1?"Tambah Produk":"Edit Produk"),u=k("");function x(b){_.value=a.value.indexOf(b),d.value=Object.assign({},b),D.value=!0}function c(b){_.value=a.value.indexOf(b),d.value=Object.assign({},b),h.value=!0}async function v(){await $fetch(`/api/produk/delete/${d.value.id_produk}`),a.value.splice(_.value,1),z()}function $(){D.value=!1,F(()=>{d.value=Object.assign({},P.value),_.value=-1})}function z(){h.value=!1,F(()=>{d.value=Object.assign({},P.value),_.value=-1})}async function G(){var b;if(_.value>-1){const s=await $fetch(`/api/produk/edit/${d.value.id_produk}`,{method:"POST",body:d.value});Object.assign(a.value[_.value],s)}else{const s=await $fetch("/api/produk/create",{method:"POST",body:d.value});(b=a.value)==null||b.push(s)}$()}return(b,s)=>{const U=m("v-icon"),J=m("v-toolbar-title"),j=m("v-select"),Q=m("v-divider"),B=m("v-spacer"),H=m("v-text-field"),w=m("v-btn"),E=m("v-card-title"),I=m("v-col"),W=m("v-row"),X=m("v-container"),Y=m("v-card-text"),K=m("v-card-actions"),A=m("v-card"),M=m("v-dialog"),Z=m("v-toolbar"),ee=m("v-data-table");return fe(),_e("div",ye,[e(ee,{headers:i,items:r(a),search:r(u),"sort-by":[{key:"nama_produk",order:"asc"}]},{top:l(()=>[e(Z,{flat:""},{default:l(()=>[e(J,null,{default:l(()=>[y("List Produk "),e(U,{size:"small",onClick:s[0]||(s[0]=o=>r(n)())},{default:l(()=>[y(" mdi-refresh ")]),_:1})]),_:1}),e(j,{label:"Status",style:{display:"inline-flex"},"item-text":"title","item-value":"value",modelValue:r(p),"onUpdate:modelValue":[s[1]||(s[1]=o=>S(p)?p.value=o:null),s[2]||(s[2]=o=>r(n)())],items:[{title:"Bisa Dijual",value:"false"},{title:"Semua",value:"true"}],variant:"outlined",density:"compact"},null,8,["modelValue"]),e(Q,{class:"mx-4",inset:"",vertical:""}),e(B),e(H,{density:"compact",variant:"solo",label:"Cari Produk","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",modelValue:r(u),"onUpdate:modelValue":s[3]||(s[3]=o=>S(u)?u.value=o:null)},null,8,["modelValue"]),e(M,{modelValue:r(D),"onUpdate:modelValue":s[8]||(s[8]=o=>S(D)?D.value=o:null),"max-width":"500px"},{activator:l(({props:o})=>[e(w,ve({color:"primary",dark:"",class:"mb-2"},o),{default:l(()=>[y(" Tambah Produk ")]),_:2},1040)]),default:l(()=>[e(A,null,{default:l(()=>[e(E,null,{default:l(()=>[T("span",ke,N(r(O)),1)]),_:1}),e(Y,null,{default:l(()=>[e(X,null,{default:l(()=>[e(W,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(H,{modelValue:r(d).nama_produk,"onUpdate:modelValue":s[4]||(s[4]=o=>r(d).nama_produk=o),label:"Nama Produk*",required:""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(H,{modelValue:r(d).harga,"onUpdate:modelValue":s[5]||(s[5]=o=>r(d).harga=o),label:"Harga*",type:"number",step:"500",required:""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(j,{label:"Status*","item-text":"title","item-value":"value",modelValue:r(d).status_id,"onUpdate:modelValue":s[6]||(s[6]=o=>r(d).status_id=o),items:r(C).status||[],variant:"outlined",required:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(j,{label:"Kategori*","item-text":"title","item-value":"value",modelValue:r(d).kategori_id,"onUpdate:modelValue":s[7]||(s[7]=o=>r(d).kategori_id=o),items:r(C).kategori||[],variant:"outlined",required:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(K,null,{default:l(()=>[e(B),e(w,{color:"blue-darken-1",variant:"text",onClick:$},{default:l(()=>[y(" Cancel ")]),_:1}),e(w,{color:"blue-darken-1",variant:"text",onClick:G},{default:l(()=>[y(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(M,{modelValue:r(h),"onUpdate:modelValue":s[9]||(s[9]=o=>S(h)?h.value=o:null),"max-width":"500px"},{default:l(()=>[e(A,null,{default:l(()=>[e(E,{class:"text-h5"},{default:l(()=>[y("Are you sure you want to delete this item?")]),_:1}),e(K,null,{default:l(()=>[e(B),e(w,{color:"blue-darken-1",variant:"text",onClick:z},{default:l(()=>[y("Cancel")]),_:1}),e(w,{color:"blue-darken-1",variant:"text",onClick:v},{default:l(()=>[y("OK")]),_:1}),e(B)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:o})=>[e(U,{size:"small",class:"me-2",onClick:ae=>x(o)},{default:l(()=>[y(" mdi-pencil ")]),_:2},1032,["onClick"]),e(U,{size:"small",onClick:ae=>c(o)},{default:l(()=>[y(" mdi-delete ")]),_:2},1032,["onClick"])]),"item.kategori_label":l(({item:o})=>[T("span",null,N(r(C).kategoriKey[o.kategori_id]),1)]),"item.status_label":l(({item:o})=>[T("span",null,N(r(C).statusKey[o.status_id]),1)]),"no-data":l(()=>[ge]),_:1},8,["items","search"])])}}});export{xe as default};
